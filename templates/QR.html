{% extends "base.html" %}
{% block title %}QR scan{% endblock %}
{% block head %}
    {{ super() }}
    <script src="https://unpkg.com/@zxing/library@latest"></script>
    <!-- https://github.com/zxing-js/library -->
{% endblock head %}
{% block content %}
    <main>
        <h1>Scan QR Code</h1>
        <div id="test">
        </div>

        <div id="qrscan-container">
            <video id="qrscan"></video>
        </div>

        <div id="qrresult">
            <p id="qrres">yeet</p>
        </div>

        <script>
            const qrReader = new ZXing.BrowserQRCodeReader();
            const inputId = undefined; //dit meegeven zodat ie op een mobile device altijd de achterste camera pakt
            const qrRes = document.getElementById('qrres');

            function decode(qrReader, selectedDeviceId){
                qrReader.decodeOnceFromVideoDevice(selectedDeviceId, 'qrscan')
                .then(result => console.log(result.text), qrRes.textContent=result.text)
                .catch(err => console.error(err));
            }
            
            function doSomething(){
                console.warn("camera ded");
            }

            decode(qrReader, inputId);
            doSomething();
        </script>
    </main>
{% endblock content %}